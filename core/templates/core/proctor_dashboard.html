{% extends 'core/base.html' %}
{% load static %}
{% load custom_tags %}


{% block content %}
<div class="container mt-4">

  <!-- ===================== Proctor Header ===================== -->
  <div class="card shadow border-0 mb-4">
    <div class="card-header bg-primary text-white d-flex justify-content-between align-items-center">
      <h4 class="mb-0">ğŸ‘©â€ğŸ« Proctor Dashboard</h4>
      <a href="{% url 'meeting_schedule' %}" class="btn btn-light btn-sm">â• Schedule Meeting</a>
    </div>

    <div class="card-body">
      <h5>ğŸ“ Your Students</h5>

      {% if students %}
        <table class="table table-striped table-hover">
          <thead class="table-dark">
            <tr>
              <th>USN</th>
              <th>Name</th>
              <th>Branch</th>
              <th>Semester</th>
              <th>Actions</th>
            </tr>
          </thead>

          <tbody>
            {% for student in students %}
              <tr>
                <td>{{ student.usn }}</td>
                <td>{{ student.user.username }}</td>
                <td>{{ student.branch }}</td>
                <td>{{ student.semester }}</td>

                <td>

                  <!-- REMOVED: View button -->
                  <!-- <a href="{% url 'student_detail' student.usn %}" class="btn btn-sm btn-outline-primary">ğŸ“„ View</a> -->

                  <a href="{% url 'student_history' student.usn %}" 
                     class="btn btn-sm btn-outline-secondary">ğŸ•“ History</a>

                  <a href="{% url 'direct_messages' %}?usn={{ student.usn }}" 
                     class="btn btn-sm btn-outline-success">ğŸ’¬ Conversation</a>

                  <a href="{% url 'proctor_select_semester' student.usn %}" 
                     class="btn btn-sm btn-primary">ğŸ“ Enter Marks</a>

                  <a href="{% url 'proctor_view_student_dashboard' student.usn %}" 
                     class="btn btn-sm btn-info text-white">ğŸ‘€ Dashboard</a>

                </td>

              </tr>
            {% endfor %}
          </tbody>

        </table>
      {% else %}
        <p class="text-muted">No students assigned to you yet.</p>
      {% endif %}
    </div>
  </div>


  <!-- ===================== Broadcast Messages ===================== -->
  <h5 class="mt-4">ğŸ“¢ HOD Broadcast Messages</h5>

  {% for b in broadcasts %}
    <div class="alert alert-info">
      <strong>{{ b.sender.username }}:</strong><br>
      {{ b.content }}<br>
      <small class="text-muted">{{ b.timestamp|date:"d M Y h:i A" }}</small>
    </div>
  {% empty %}
    <p class="text-muted">No broadcast messages.</p>
  {% endfor %}

</div>

<style>
  .card {
    border-radius: 12px;
  }
  table th, table td {
    vertical-align: middle;
    text-align: center;
  }
</style>

{% endblock %}
